<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>HydroNet Dashboard Final - Advanced</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom styles to override or extend Tailwind if necessary */
        body {
            font-family: 'Inter', sans-serif; /* Using Inter font as per instructions */
        }
        /* Ensure home section background covers */
        #home {
            background-image: url('hydronetbg.jpg'); /* Placeholder image, no text */
            position: relative; /* Needed for overlay and particles */
            overflow: hidden; /* Hide particles outside the section */
        }
        /* Overlay for background image to reduce transparency */
        #home::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4); /* Dark overlay, 40% opacity */
            z-index: 1; /* Place above background, below content and particles */
        }
        #home h1, #home p {
            z-index: 3; /* Ensure text is above the overlay and particles */
            position: relative; /* Needed for z-index to work */
        }
        #particles-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2; /* Between background and text */
        }

        /* Dark mode transitions */
        html.dark body {
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
        }
        html.dark .navbar {
            background-color: #00332e;
            background-image: linear-gradient(to right, #00332e, #004d40); /* Darker gradient */
        }
        html.dark .navbar-menu a {
            color: #a7f3d0;
        }
        html.dark .card,
        html.dark .chart-container,
        html.dark .recommendation-column,
        html.dark .recommendation,
        html.dark .reports th,
        html.dark .reports td,
        html.dark .help-card,
        html.dark .modal-content {
            background-color: #2d3748;
            color: #e2e8f0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        html.dark .reports th {
            background-color: #004d40;
        }
        html.dark .controls input[type="number"] {
            background-color: #4a5568;
            border-color: #667eea;
            color: #e2e8f0;
        }
        html.dark .help-section {
            background-color: #223333;
        }
        html.dark .help-card {
            border-left-color: #00796b;
        }
        html.dark .footer {
            background-color: #00332e;
        }

        /* Modal styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 20; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 80%; /* Could be responsive */
            max-width: 500px;
            text-align: center;
            position: relative;
        }

        .close-button {
            position: absolute;
            top: 10px;
            right: 20px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
            color: #333;
            text-decoration: none;
            cursor: pointer;
        }
        /* Help page accordion style */
        .accordion-item {
            border-bottom: 1px solid #e2e8f0;
        }
        .accordion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background-color: #f0fdf4; /* Light green background */
            cursor: pointer;
            font-weight: bold;
            border-radius: 8px;
            margin-bottom: 5px;
            transition: background-color 0.3s ease;
        }
        html.dark .accordion-header {
            background-color: #36454F; /* Darker background for dark mode */
        }
        .accordion-header:hover {
            background-color: #e6fffa;
        }
        html.dark .accordion-header:hover {
            background-color: #4A5568;
        }
        .accordion-content {
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            margin-top: -5px; /* Overlap slightly with header */
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: none; /* Hidden by default */
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        html.dark .accordion-content {
            background-color: #2d3748;
        }

        /* Dark mode specific text color adjustments for readability */
        html.dark h2 {
            color: #81e6d9; /* Lighter teal for headings in dark mode */
        }
        html.dark .accordion-header h3 {
            color: #a7f3d0; /* Lighter color for accordion headers in dark mode */
        }
        html.dark .accordion-content p {
            color: #e2e8f0; /* Ensure content text is light in dark mode */
        }
        html.dark .reports th {
            color: #e2e8f0; /* Ensure table headers are readable */
        }
        html.dark .reports td {
            color: #e2e8f0; /* Ensure table data is readable */
        }
        html.dark .controls label {
            color: #e2e8f0; /* Ensure label text is readable */
        }
        /* Chart.js text color in dark mode */
        html.dark .chart-container canvas {
            /* Invert colors for dark mode charts, adjust hue slightly */
            filter: invert(0.9) hue-rotate(180deg);
        }

        /* Custom Toast Notification */
        #toast-notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
            font-weight: 500;
        }
        #toast-notification.show {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body class="bg-emerald-50 text-gray-800 transition-colors duration-300">

    <!-- Navbar -->
    <nav class="navbar flex justify-between items-center bg-gradient-to-r from-teal-700 to-teal-800 p-4 fixed w-full top-0 z-10 shadow-lg rounded-b-lg">
        <div class="navbar-logo text-2xl font-bold text-white cursor-pointer" onclick="showSection('home')">HydroNet</div>
        <div class="navbar-menu flex flex-wrap justify-end items-center gap-4">
            <a class="text-white hover:underline font-medium whitespace-nowrap px-2 py-1 rounded-md hover:bg-teal-600 transition-colors cursor-pointer" onclick="showSection('home')">Home</a>
            <a class="text-white hover:underline font-medium whitespace-nowrap px-2 py-1 rounded-md hover:bg-teal-600 transition-colors cursor-pointer" onclick="showSection('sensors')">Sensors</a>
            <a class="text-white hover:underline font-medium whitespace-nowrap px-2 py-1 rounded-md hover:bg-teal-600 transition-colors cursor-pointer" onclick="showSection('graphs')">Graphs</a>
            <a class="text-white hover:underline font-medium whitespace-nowrap px-2 py-1 rounded-md hover:bg-teal-600 transition-colors cursor-pointer" onclick="showSection('ai')">AI</a>
            <a class="text-white hover:underline font-medium whitespace-nowrap px-2 py-1 rounded-md hover:bg-teal-600 transition-colors cursor-pointer" onclick="showSection('reports')">Reports</a>
            <a class="text-white hover:underline font-medium whitespace-nowrap px-2 py-1 rounded-md hover:bg-teal-600 transition-colors cursor-pointer" onclick="showSection('controls')">Controls</a>
            <a class="text-white hover:underline font-medium whitespace-nowrap px-2 py-1 rounded-md hover:bg-teal-600 transition-colors cursor-pointer" onclick="showSection('help')">Help</a>
            <button id="darkModeToggle" class="text-white text-xl px-2 py-1 rounded-md hover:bg-teal-600 transition-colors cursor-pointer">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </nav>

    <!-- Home Section -->
    <div id="home" class="section flex-col h-screen justify-center items-center text-center bg-cover bg-center" style="display:flex;">
        <canvas id="particles-canvas"></canvas>
        <h1 class="text-6xl md:text-7xl font-extrabold text-white drop-shadow-lg">HYDRONET</h1>
        <p class="text-2xl md:text-3xl mt-4 text-white drop-shadow-md">The Floating Farm That Drinks Air!</p>
    </div>

    <!-- Sensors Section -->
    <div id="sensors" class="section pt-24 px-4 min-h-screen box-border hidden opacity-0 transition-opacity duration-500">
        <h2 class="text-3xl font-bold border-b-4 border-teal-700 pb-2 mb-8 text-teal-700">Real-Time Sensor Data</h2>
        <div class="cards grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5">
            <div class="card p-5 text-center border-l-8 border-green-500 bg-white rounded-xl shadow-md">
                <i class="fas fa-flask text-green-500 text-3xl mb-2"></i>
                <h3 class="text-xl font-semibold">pH</h3>
                <p id="phValue" class="text-2xl font-bold">6.5</p>
                <div class="timestamp text-xs text-gray-600">Updated: <span id="phTimestamp">12:00</span></div>
            </div>
            <div class="card p-5 text-center border-l-8 border-yellow-500 bg-white rounded-xl shadow-md">
                <i class="fas fa-bolt text-yellow-500 text-3xl mb-2"></i>
                <h3 class="text-xl font-semibold">EC</h3>
                <p id="ecValue" class="text-2xl font-bold">2.0 mS/cm</p>
                <div class="timestamp text-xs text-gray-600">Updated: <span id="ecTimestamp">12:01</span></div>
            </div>
            <div class="card p-5 text-center border-l-8 border-green-500 bg-white rounded-xl shadow-md">
                <i class="fas fa-thermometer-half text-green-500 text-3xl mb-2"></i>
                <h3 class="text-xl font-semibold">Temperature</h3>
                <p id="tempValue" class="text-2xl font-bold">24Â°C</p>
                <div class="timestamp text-xs text-gray-600">Updated: <span id="tempTimestamp">12:02</span></div>
            </div>
            <div class="card p-5 text-center border-l-8 border-red-500 bg-white rounded-xl shadow-md">
                <i class="fas fa-cloud-showers-heavy text-red-500 text-3xl mb-2"></i>
                <h3 class="text-xl font-semibold">Humidity</h3>
                <p id="humidityValue" class="text-2xl font-bold">85%</p>
                <div class="timestamp text-xs text-gray-600">Updated: <span id="humidityTimestamp">12:03</span></div>
            </div>
            <div class="card p-5 text-center border-l-8 border-green-500 bg-white rounded-xl shadow-md">
                <i class="fas fa-water text-green-500 text-3xl mb-2"></i>
                <h3 class="text-xl font-semibold">Water Level</h3>
                <p id="waterLevelValue" class="text-2xl font-bold">75%</p>
                <div class="timestamp text-xs text-gray-600">Updated: <span id="waterLevelTimestamp">12:04</span></div>
            </div>
        </div>
    </div>

    <!-- Graphs Section -->
    <div id="graphs" class="section pt-24 px-4 min-h-screen box-border hidden opacity-0 transition-opacity duration-500">
        <h2 class="text-3xl font-bold border-b-4 border-teal-700 pb-2 mb-8 text-teal-700">Live Monitoring Graphs</h2>
        <div class="charts grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="chart-container bg-white rounded-xl p-5 shadow-md"><canvas id="phChart"></canvas></div>
            <div class="chart-container bg-white rounded-xl p-5 shadow-md"><canvas id="ecChart"></canvas></div>
            <div class="chart-container bg-white rounded-xl p-5 shadow-md"><canvas id="tempChart"></canvas></div>
            <div class="chart-container bg-white rounded-xl p-5 shadow-md"><canvas id="waterChart"></canvas></div>
        </div>
    </div>

    <!-- AI/Automation Section -->
    <div id="ai" class="section pt-24 px-4 min-h-screen box-border hidden opacity-0 transition-opacity duration-500">
        <h2 class="text-3xl font-bold border-b-4 border-teal-700 pb-2 mb-8 text-teal-700">AI/Automation Recommendations</h2>
        <div class="ai-columns grid grid-cols-1 md:grid-cols-3 gap-5">
            <div class="recommendation-column bg-white rounded-xl p-5 shadow-md">
                <h3 class="text-xl font-semibold mb-4 text-green-700"><i class="fas fa-check-double text-green-600 mr-2"></i> Normal</h3>
                <div class="recommendation flex items-center my-4 font-medium p-3 rounded-lg shadow-sm bg-gray-50 border-l-4 border-green-500">
                    <i class="fas fa-check-circle text-green-500 mr-3 text-xl"></i> All parameters stable.
                </div>
                <div class="recommendation flex items-center my-4 font-medium p-3 rounded-lg shadow-sm bg-gray-50 border-l-4 border-green-500">
                    <i class="fas fa-check-circle text-green-500 mr-3 text-xl"></i> Nutrient levels within safe range.
                </div>
            </div>
            <div class="recommendation-column bg-white rounded-xl p-5 shadow-md">
                <h3 class="text-xl font-semibold mb-4 text-yellow-700"><i class="fas fa-triangle-exclamation text-yellow-600 mr-2"></i> Warnings</h3>
                <div class="recommendation flex items-center my-4 font-medium p-3 rounded-lg shadow-sm bg-gray-50 border-l-4 border-yellow-500">
                    <i class="fas fa-exclamation-triangle text-yellow-500 mr-3 text-xl"></i> Humidity rising; adjust ventilation soon.
                </div>
                <div class="recommendation flex items-center my-4 font-medium p-3 rounded-lg shadow-sm bg-gray-50 border-l-4 border-yellow-500">
                    <i class="fas fa-exclamation-triangle text-yellow-500 mr-3 text-xl"></i> Slight EC fluctuation detected.
                </div>
            </div>
            <div class="recommendation-column bg-white rounded-xl p-5 shadow-md">
                <h3 class="text-xl font-semibold mb-4 text-red-700"><i class="fas fa-circle-exclamation text-red-600 mr-2"></i> Critical</h3>
                <div class="recommendation flex items-center my-4 font-medium p-3 rounded-lg shadow-sm bg-gray-50 border-l-4 border-red-500">
                    <i class="fas fa-exclamation-circle text-red-500 mr-3 text-xl"></i> Water tank critically low; refill immediately!
                </div>
                <div class="recommendation flex items-center my-4 font-medium p-3 rounded-lg shadow-sm bg-gray-50 border-l-4 border-red-500">
                    <i class="fas fa-exclamation-circle text-red-500 mr-3 text-xl"></i> pH exceeded upper safe limit!
                </div>
            </div>
        </div>
    </div>

    <!-- Reports Section -->
    <div id="reports" class="section pt-24 px-4 min-h-screen box-border hidden opacity-0 transition-opacity duration-500">
        <h2 class="text-3xl font-bold border-b-4 border-teal-700 pb-2 mb-8 text-teal-700">Reports / Historical Data</h2>
        <div class="flex flex-wrap items-center gap-4 mb-6">
            <label class="font-medium">Filter by date: <input type="date" class="p-2 border border-gray-300 rounded-md"></label>
            <label class="font-medium">Parameter:
                <select class="p-2 border border-gray-300 rounded-md">
                    <option>All</option><option>pH</option><option>EC</option><option>Temperature</option><option>Humidity</option>
                </select>
            </label>
            <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors">Download CSV</button>
        </div>
        <div class="overflow-x-auto rounded-lg shadow-md">
            <table class="w-full border-collapse">
                <thead>
                    <tr>
                        <th class="border border-gray-300 p-3 text-center bg-teal-700 text-white">Date/Time</th>
                        <th class="border border-gray-300 p-3 text-center bg-teal-700 text-white">pH</th>
                        <th class="border border-gray-300 p-3 text-center bg-teal-700 text-white">EC</th>
                        <th class="border border-gray-300 p-3 text-center bg-teal-700 text-white">Temp</th>
                        <th class="border border-gray-300 p-3 text-center bg-teal-700 text-white">Humidity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td class="border border-gray-300 p-3 text-center bg-white">2025-07-05 12:00</td><td class="border border-gray-300 p-3 text-center bg-white">6.5</td><td class="border border-gray-300 p-3 text-center bg-white">2.0</td><td class="border border-gray-300 p-3 text-center bg-white">24Â°C</td><td class="border border-gray-300 p-3 text-center bg-white">85%</td></tr>
                    <tr><td class="border border-gray-300 p-3 text-center bg-white">2025-07-04 12:00</td><td class="border border-gray-300 p-3 text-center bg-white">6.4</td><td class="border border-gray-300 p-3 text-center bg-white">2.1</td><td class="border border-gray-300 p-3 text-center bg-white">23Â°C</td><td class="border border-gray-300 p-3 text-center bg-white">80%</td></tr>
                    <tr><td class="border border-gray-300 p-3 text-center bg-white">2025-07-03 12:00</td><td class="border border-gray-300 p-3 text-center bg-white">6.3</td><td class="border border-gray-300 p-3 text-center bg-white">2.0</td><td class="border border-gray-300 p-3 text-center bg-white">24Â°C</td><td class="border border-gray-300 p-3 text-center bg-white">82%</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Controls Section -->
    <div id="controls" class="section pt-24 px-4 min-h-screen box-border hidden opacity-0 transition-opacity duration-500">
        <h2 class="text-3xl font-bold border-b-4 border-teal-700 pb-2 mb-8 text-teal-700 text-center">Remote Controls</h2>
        <div class="target-inputs flex flex-col sm:flex-row justify-center items-center gap-6 mb-10">
            <label class="font-medium text-lg">Target pH:
                <input type="number" value="6.5" class="w-28 ml-3 p-2 border border-gray-300 rounded-md text-lg focus:outline-none focus:ring-2 focus:ring-teal-500">
            </label>
            <label class="font-medium text-lg">Target EC:
                <input type="number" value="2.0" class="w-28 ml-3 p-2 border border-gray-300 rounded-md text-lg focus:outline-none focus:ring-2 focus:ring-teal-500">
            </label>
        </div>
        <div class="buttons flex flex-wrap justify-center gap-10">
            <button class="start w-40 h-40 rounded-full text-xl text-white border-none cursor-pointer font-semibold shadow-lg transition-transform duration-200 hover:scale-110 bg-green-700 hover:bg-green-800" onclick="showConfirmationModal('start')">Start</button>
            <button class="stop w-40 h-40 rounded-full text-xl text-white border-none cursor-pointer font-semibold shadow-lg transition-transform duration-200 hover:scale-110 bg-red-700 hover:bg-red-800" onclick="showConfirmationModal('stop')">Stop</button>
            <button class="other w-40 h-40 rounded-full text-xl text-white border-none cursor-pointer font-semibold shadow-lg transition-transform duration-200 hover:scale-110 bg-teal-700 hover:bg-teal-800" onclick="showConfirmationModal('adjust')">Adjust</button>
            <button class="other w-40 h-40 rounded-full text-xl text-white border-none cursor-pointer font-semibold shadow-lg transition-transform duration-200 hover:scale-110 bg-teal-700 hover:bg-teal-800" onclick="showConfirmationModal('reset')">Reset</button>
        </div>
    </div>

    <!-- Help Section -->
    <div id="help" class="section pt-24 px-4 min-h-screen box-border bg-emerald-100 hidden opacity-0 transition-opacity duration-500">
        <h2 class="text-3xl font-bold border-b-4 border-teal-700 pb-2 mb-8 text-teal-700">ðŸ“˜ Help & Documentation</h2>
        <div class="space-y-4">
            <div class="accordion-item">
                <div class="accordion-header bg-white shadow-sm rounded-lg flex items-center justify-between p-4 cursor-pointer">
                    <h3 class="text-lg font-semibold text-teal-800">What is the ideal pH range for my crops?</h3>
                    <i class="fas fa-chevron-down text-teal-600"></i>
                </div>
                <div class="accordion-content bg-white p-4 shadow-sm rounded-lg text-gray-700">
                    <p>The ideal pH range for most hydroponic crops is between 6.0 and 6.5. Maintaining this range ensures optimal nutrient absorption by the plants.</p>
                </div>
            </div>

            <div class="accordion-item">
                <div class="accordion-header bg-white shadow-sm rounded-lg flex items-center justify-between p-4 cursor-pointer">
                    <h3 class="text-lg font-semibold text-teal-800">How often should I check the EC levels?</h3>
                    <i class="fas fa-chevron-down text-teal-600"></i>
                </div>
                <div class="accordion-content bg-white p-4 shadow-sm rounded-lg text-gray-700">
                    <p>EC (Electrical Conductivity) levels should be checked daily, or even multiple times a day, especially during critical growth stages. The ideal range is typically 1.8-2.2 mS/cm, but this can vary by crop.</p>
                </div>
            </div>

            <div class="accordion-item">
                <div class="accordion-header bg-white shadow-sm rounded-lg flex items-center justify-between p-4 cursor-pointer">
                    <h3 class="text-lg font-semibold text-teal-800">What is the optimal temperature for hydroponic plants?</h3>
                    <i class="fas fa-chevron-down text-teal-600"></i>
                </div>
                <div class="accordion-content bg-white p-4 shadow-sm rounded-lg text-gray-700">
                    <p>Most hydroponic crops thrive in temperatures between 20-26Â°C (68-79Â°F). Extreme temperatures can stress plants and hinder growth.</p>
                </div>
            </div>

            <div class="accordion-item">
                <div class="accordion-header bg-white shadow-sm rounded-lg flex items-center justify-between p-4 cursor-pointer">
                    <h3 class="text-lg font-semibold text-teal-800">Why is humidity important and how do I manage it?</h3>
                    <i class="fas fa-chevron-down text-teal-600"></i>
                </div>
                <div class="accordion-content bg-white p-4 shadow-sm rounded-lg text-gray-700">
                    <p>Humidity plays a crucial role in plant transpiration and overall health. High humidity can lead to fungal diseases, while low humidity can cause wilting. Maintaining moderate humidity (e.g., 40-60%) is key. You can manage it with proper ventilation and dehumidifiers.</p>
                </div>
            </div>

            <div class="accordion-item">
                <div class="accordion-header bg-white shadow-sm rounded-lg flex items-center justify-between p-4 cursor-pointer">
                    <h3 class="text-lg font-semibold text-teal-800">How do I use the remote controls effectively?</h3>
                    <i class="fas fa-chevron-down text-teal-600"></i>
                </div>
                <div class="accordion-content bg-white p-4 shadow-sm rounded-lg text-gray-700">
                    <p>The remote controls allow you to adjust target pH and EC levels, and initiate system actions like starting or stopping pumps. Always monitor sensor data and AI recommendations before making adjustments to ensure optimal plant health.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer text-center p-5 bg-teal-900 text-white rounded-t-lg">
        <p>Â© 2025 HydroNet. Contact: <a href="#" class="text-yellow-300 hover:underline" onclick="showContactModal()">support.hydronet@gmail.com</a> | +91-9845290809</p>
        <p class="mt-2"><a href="#" class="text-yellow-300 hover:underline">Project Documentation</a> | <a href="#" class="text-yellow-300 hover:underline">Pitch Deck</a></p>
    </footer>

    <!-- Contact Modal -->
    <div id="contactModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('contactModal')">&times;</span>
            <h3 class="text-2xl font-bold mb-4 text-teal-700">Contact Us</h3>
            <p class="mb-2">Email: support.hydronet@gmail.com</p>
            <p class="mb-4">Phone: +91-9845290809</p>
            <p class="text-sm text-gray-600">Feel free to reach out for any inquiries!</p>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('confirmationModal')">&times;</span>
            <h3 id="confirmationTitle" class="text-2xl font-bold mb-4 text-teal-700">Confirm Action</h3>
            <p id="confirmationMessage" class="mb-6">Are you sure you want to perform this action?</p>
            <div class="flex justify-center gap-4">
                <button class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors" onclick="executeControlAction(true)">Confirm</button>
                <button class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors" onclick="executeControlAction(false)">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast-notification"></div>

    <script>
        // --- Global Chart Instances ---
        let phChart, ecChart, tempChart, waterChart;

        // --- Utility Functions ---
        function getCurrentTime() {
            const now = new Date();
            return now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });
        }

        function getRandomArbitrary(min, max) {
            return Math.random() * (max - min) + min;
        }

        function showToast(message, duration = 3000) {
            const toast = document.getElementById('toast-notification');
            toast.innerText = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // --- Section Navigation ---
        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => {
                s.style.display = 'none';
                s.classList.remove('opacity-100'); // Reset opacity for fade-in
                s.classList.add('opacity-0');
            });

            const targetSection = document.getElementById(id);
            targetSection.style.display = id === 'home' ? 'flex' : 'block';
            
            // Trigger fade-in after display is set
            setTimeout(() => {
                targetSection.classList.remove('opacity-0');
                targetSection.classList.add('opacity-100');
            }, 50); // Small delay to allow display change to register

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- Chart Initialization ---
        function initializeCharts() {
            const commonChartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: {
                            color: 'var(--text-color)' // Dynamic color for legend labels
                        }
                    },
                    title: {
                        display: true,
                        font: { size: 16, weight: 'bold' },
                        color: 'var(--text-color)' // Dynamic color for title
                    }
                },
                scales: {
                    x: {
                        ticks: { color: 'var(--text-color)' }, // Dynamic color for x-axis ticks
                        grid: { color: 'rgba(100, 100, 100, 0.2)' } // Lighter grid lines
                    },
                    y: {
                        ticks: { color: 'var(--text-color)' }, // Dynamic color for y-axis ticks
                        grid: { color: 'rgba(100, 100, 100, 0.2)' }, // Lighter grid lines
                        beginAtZero: false,
                        title: {
                            display: true,
                            color: 'var(--text-color)' // Dynamic color for y-axis title
                        }
                    }
                }
            };

            phChart = new Chart(document.getElementById('phChart'), {
                type: 'line',
                data: { labels: ['11:00','11:30','12:00'], datasets: [{label: 'pH', data: [6.3,6.4,6.5], borderColor: '#00796b', backgroundColor: 'rgba(0, 121, 107, 0.1)', fill: true, tension: 0.3}] },
                options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, title: { ...commonChartOptions.plugins.title, text: 'pH Levels Over Time' } }, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, title: { ...commonChartOptions.scales.y.title, text: 'pH Value' } } } }
            });

            ecChart = new Chart(document.getElementById('ecChart'), {
                type: 'line',
                data: { labels: ['11:00','11:30','12:00'], datasets: [{label: 'EC (mS/cm)', data: [1.9,2.0,2.1], borderColor: '#f57c00', backgroundColor: 'rgba(245, 124, 0, 0.1)', fill: true, tension: 0.3}] },
                options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, title: { ...commonChartOptions.plugins.title, text: 'EC Levels Over Time' } }, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y.title, text: 'EC (mS/cm)' } } }
            });

            tempChart = new Chart(document.getElementById('tempChart'), {
                type: 'line',
                data: { labels: ['11:00','11:30','12:00'], datasets: [{label: 'Temperature (Â°C)', data: [23,24,24], borderColor: '#1976d2', backgroundColor: 'rgba(25, 118, 210, 0.1)', fill: true, tension: 0.3}] },
                options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, title: { ...commonChartOptions.plugins.title, text: 'Temperature Over Time' } }, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y.title, text: 'Temperature (Â°C)' } } }
            });

            waterChart = new Chart(document.getElementById('waterChart'), {
                type: 'line',
                data: { labels: ['11:00','11:30','12:00'], datasets: [{label: 'Water Level (%)', data: [75,78,75], borderColor: '#388e3c', backgroundColor: 'rgba(56, 142, 60, 0.1)', fill: true, tension: 0.3}] },
                options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, title: { ...commonChartOptions.plugins.title, text: 'Water Level Over Time' } }, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y.title, text: 'Water Level (%)', beginAtZero: true, max: 100 } } }
            });
        }

        // --- Simulated Real-time Data Updates ---
        function updateSensorData() {
            const now = getCurrentTime();

            // pH
            let currentPh = parseFloat(document.getElementById('phValue').innerText);
            let newPh = (currentPh + getRandomArbitrary(-0.1, 0.1)).toFixed(1);
            newPh = Math.max(6.0, Math.min(7.0, newPh)); // Keep pH within a reasonable range
            document.getElementById('phValue').innerText = newPh;
            document.getElementById('phTimestamp').innerText = now;
            phChart.data.labels.push(now);
            phChart.data.datasets[0].data.push(newPh);
            if (phChart.data.labels.length > 10) { // Keep last 10 data points
                phChart.data.labels.shift();
                phChart.data.datasets[0].data.shift();
            }
            phChart.update();

            // EC
            let currentEc = parseFloat(document.getElementById('ecValue').innerText);
            let newEc = (currentEc + getRandomArbitrary(-0.05, 0.05)).toFixed(2);
            newEc = Math.max(1.5, Math.min(2.5, newEc)); // Keep EC within a reasonable range
            document.getElementById('ecValue').innerText = `${newEc} mS/cm`;
            document.getElementById('ecTimestamp').innerText = now;
            ecChart.data.labels.push(now);
            ecChart.data.datasets[0].data.push(newEc);
            if (ecChart.data.labels.length > 10) {
                ecChart.data.labels.shift();
                ecChart.data.datasets[0].data.shift();
            }
            ecChart.update();

            // Temperature
            let currentTemp = parseFloat(document.getElementById('tempValue').innerText);
            let newTemp = (currentTemp + getRandomArbitrary(-0.5, 0.5)).toFixed(0);
            newTemp = Math.max(20, Math.min(28, newTemp)); // Keep Temp within a reasonable range
            document.getElementById('tempValue').innerText = `${newTemp}Â°C`;
            document.getElementById('tempTimestamp').innerText = now;
            tempChart.data.labels.push(now);
            tempChart.data.datasets[0].data.push(newTemp);
            if (tempChart.data.labels.length > 10) {
                tempChart.data.labels.shift();
                tempChart.data.datasets[0].data.shift();
            }
            tempChart.update();

            // Humidity
            let currentHumidity = parseFloat(document.getElementById('humidityValue').innerText);
            let newHumidity = (currentHumidity + getRandomArbitrary(-2, 2)).toFixed(0);
            newHumidity = Math.max(60, Math.min(90, newHumidity)); // Keep Humidity within a reasonable range
            document.getElementById('humidityValue').innerText = `${newHumidity}%`;
            document.getElementById('humidityTimestamp').innerText = now;

            // Water Level
            let currentWaterLevel = parseFloat(document.getElementById('waterLevelValue').innerText);
            let newWaterLevel = (currentWaterLevel + getRandomArbitrary(-1, 1)).toFixed(0);
            newWaterLevel = Math.max(50, Math.min(100, newWaterLevel)); // Keep Water Level within a reasonable range
            document.getElementById('waterLevelValue').innerText = `${newWaterLevel}%`;
            document.getElementById('waterLevelTimestamp').innerText = now;
            waterChart.data.labels.push(now);
            waterChart.data.datasets[0].data.push(newWaterLevel);
            if (waterChart.data.labels.length > 10) {
                waterChart.data.labels.shift();
                waterChart.data.datasets[0].data.shift();
            }
            waterChart.update();
        }

        let updateInterval; // To store the interval ID

        // --- Dark Mode Toggle ---
        const darkModeToggle = document.getElementById('darkModeToggle');
        darkModeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            const isDarkMode = document.documentElement.classList.contains('dark');
            darkModeToggle.querySelector('i').className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            updateChartColors(); // Update chart colors on theme change
        });

        // Function to update Chart.js colors based on theme
        function updateChartColors() {
            const isDarkMode = document.documentElement.classList.contains('dark');
            const textColor = isDarkMode ? '#e2e8f0' : '#333';
            const gridColor = isDarkMode ? 'rgba(100, 100, 100, 0.2)' : 'rgba(200, 200, 200, 0.2)';

            document.documentElement.style.setProperty('--text-color', textColor);

            [phChart, ecChart, tempChart, waterChart].forEach(chart => {
                if (chart) {
                    chart.options.plugins.legend.labels.color = textColor;
                    chart.options.plugins.title.color = textColor;
                    chart.options.scales.x.ticks.color = textColor;
                    chart.options.scales.x.grid.color = gridColor;
                    chart.options.scales.y.ticks.color = textColor;
                    chart.options.scales.y.grid.color = gridColor;
                    chart.options.scales.y.title.color = textColor;
                    chart.update();
                }
            });
        }

        // Apply theme on load
        if (localStorage.getItem('theme') === 'dark' || (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            darkModeToggle.querySelector('i').className = 'fas fa-sun';
        } else {
            darkModeToggle.querySelector('i').className = 'fas fa-moon';
        }

        // --- Modal Functions ---
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
            document.getElementById(modalId).classList.add('flex');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.getElementById(modalId).classList.remove('flex');
        }

        function showContactModal() {
            showModal('contactModal');
        }

        let currentControlAction = '';

        function showConfirmationModal(action) {
            currentControlAction = action;
            document.getElementById('confirmationTitle').innerText = `Confirm ${action.charAt(0).toUpperCase() + action.slice(1)} Action`;
            document.getElementById('confirmationMessage').innerText = `Are you sure you want to ${action} the system?`;
            showModal('confirmationModal');
        }

        function executeControlAction(confirmed) {
            closeModal('confirmationModal');
            if (confirmed) {
                console.log(`Action '${currentControlAction}' confirmed and executed.`);
                showToast(`System command '${currentControlAction}' sent successfully!`);
            } else {
                console.log(`Action '${currentControlAction}' cancelled.`);
                showToast(`Action '${currentControlAction}' cancelled.`, 2000);
            }
            currentControlAction = '';
        }

        // --- Accordion Functionality for Help page ---
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                const icon = header.querySelector('i');

                document.querySelectorAll('.accordion-content').forEach(item => {
                    if (item !== content && item.style.display === 'block') {
                        item.style.display = 'none';
                        item.previousElementSibling.querySelector('i').classList.remove('fa-chevron-up');
                        item.previousElementSibling.querySelector('i').classList.add('fa-chevron-down');
                    }
                });

                if (content.style.display === 'block') {
                    content.style.display = 'none';
                    icon.classList.remove('fa-chevron-up');
                    icon.classList.add('fa-chevron-down');
                } else {
                    content.style.display = 'block';
                    icon.classList.remove('fa-chevron-down');
                    icon.classList.add('fa-chevron-up');
                }
            });
        });

        // --- Particle Animation for Home Page ---
        function initParticles() {
            const canvas = document.getElementById('particles-canvas');
            const ctx = canvas.getContext('2d');
            let particles = [];
            const particleCount = 100;
            const maxRadius = 2;
            const minRadius = 0.5;
            const maxSpeed = 0.5;

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }

            class Particle {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.radius = getRandomArbitrary(minRadius, maxRadius);
                    this.color = `rgba(255, 255, 255, ${getRandomArbitrary(0.2, 0.7)})`;
                    this.vx = getRandomArbitrary(-maxSpeed, maxSpeed);
                    this.vy = getRandomArbitrary(-maxSpeed, maxSpeed);
                }

                draw() {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                    ctx.fillStyle = this.color;
                    ctx.fill();
                }

                update() {
                    this.x += this.vx;
                    this.y += this.vy;

                    if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
                    if (this.y < 0 || this.y > canvas.height) this.vy *= -1;

                    this.draw();
                }
            }

            function createParticles() {
                particles = []; // Clear existing particles on resize
                for (let i = 0; i < particleCount; i++) {
                    particles.push(new Particle());
                }
            }

            function animateParticles() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => p.update());
                requestAnimationFrame(animateParticles);
            }

            window.addEventListener('resize', () => {
                resizeCanvas();
                createParticles(); // Recreate particles on resize
            });

            resizeCanvas();
            createParticles();
            animateParticles();
        }


        // --- Initial Setup on DOM Load ---
        document.addEventListener('DOMContentLoaded', () => {
            showSection('home');
            initializeCharts();
            updateChartColors(); // Set initial chart colors
            initParticles(); // Start particle animation
            updateInterval = setInterval(updateSensorData, 3000); // Update data every 3 seconds
        });
    </script>

</body>
</html>
